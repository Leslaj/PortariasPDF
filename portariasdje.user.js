(function(){const e=".portaria-viewer{position:fixed;top:10px;right:10px;width:80%;height:90%;background:white;border:1px solid black;font-family:Arial,sans-serif;display:flex;flex-direction:column;z-index:9999;}.portaria-viewer *{box-sizing:border-box;}.portaria-header{padding:10px;background:#f0f0f0;border-bottom:1px solid #ccc;}.portaria-content{flex-grow:1;overflow:auto;padding:20px;}.portaria-footer{padding:10px;background:#f0f0f0;border-top:1px solid #ccc;display:flex;justify-content:space-between;}.portaria-text{white-space:pre-wrap;text-align:left;font-size:14px;line-height:1.5;}.portaria-index{max-height:200px;overflow-y:auto;margin-bottom:10px;}.portaria-index a{display:block;padding:5px;text-decoration:none;color:blue;}.portaria-index a:hover{background:#f0f0f0;}.button{padding:5px 10px;margin:0 5px;cursor:pointer;}";function t(e){return e.replace(/\n\s*(\d+\s+\w+\s+\w+\s*,\s*\w+\s+\d+\s+\w+\s+\d+\s+\d+\s*)/g,"").replace(/(\n)+/g,"\n").replace(/CONSIDERANDO /g,"\n\nCONSIDERANDO ").replace(/RESOLVE:?/g,"\n\nRESOLVE:\n\n").replace(/(Art\.\s*\d+º)/g,"\n\n$1").replace(/Diário da Justiça Eletrônico.*?endereço eletrônico http:\/\/www\.tre-am\.jus\.br\//gs,"").replace(/^.*?PORTARIA/s,"PORTARIA").replace(/(\w)(\(Assinatura)/,"\n\n$1\n\n$2").replace(/\(Assinatura Eletrônica\)/g,"\n(Assinatura Eletrônica)\n").replace(/^(.*?)(\n.*?TRE\/AM)/gm,"$1\n$2").replace(/(\d+\.\s*[A-Z])/gm,"\n$1").replace(/Ano.*\d+$/gm,"").replace(/(.*)\1/,"$1").replace(/\n{3,}/g,"\n\n").trim()}function n(e){const t=e.match(/PORTARIA.*?Nº\s*(\d+)[,\s]+DE\s+(\d+)\s+DE\s+(\w+)\s+DE\s+(\d{4})/i);return t?`PORTARIA Nº ${t[1]}, DE ${t[2]} DE ${t[3].toUpperCase()} DE ${t[4]}`:"Título não encontrado"}function r(e){return e.replace(/^([IVX]+\s*-\s*)/gm,"\n$1").replace(/(\n\s*\d+\s*\.\s*)/g,"\n$1")}function a(e){const t=e.match(/\|.*\|.*\|/);if(t){const n=t[0].split("|").filter(e=>e.trim()).length,r=new RegExp(`((?:\\|[^\\n]*){${n-1}}\\|)\\s*\\n\\s*(?=\\|)`,"g");return e.replace(r,"$1\n").replace(/\|\s*\n\s*\|/g,"||\n|").replace(/\s*\|\s*/g,"|").split("\n").map(e=>e.trim()).filter(e=>e&&!/^[-|]+$/.test(e)).join("\n")}}async function o(){const e=PDFViewerApplication.pdfDocument;let n="";for(let r=1;r<=e.numPages;r++){const a=await e.getPage(r),o=await a.getTextContent();n+=o.items.map(e=>e.str).join(" ")+"\n"}return t(n)}function i(e){const t=/PORTARIA[^\n]*(?:\n(?!PORTARIA)[^\n]*)*/g,o=e.match(t)||[];return o.map(e=>{const t=n(e),o=e.replace(t,"").trim(),i=e.match(/p\.\s*(\d+)/),s=i?i[1]:"",c=r(a(o));return`# ${t}\n\n${c}\n\nEste texto não substitui o publicado no DJE-AM nº 129, de 22/7/2024, p. ${s}.`})}function s(t){const n=document.createElement("div");n.className="portaria-viewer",n.innerHTML=`<style>${e}</style><div class="portaria-header"><h2>Portarias TRE-AM</h2><div class="portaria-index"></div><div><label><input type="checkbox" id="compactView"> Visualização Compacta</label><button id="toggleView" class="button">Alternar Visualização</button></div></div><div class="portaria-content"></div><div class="portaria-footer"><div><button id="prevPortaria" class="button">Anterior</button><span id="portariaCounter"></span><button id="nextPortaria" class="button">Próxima</button></div><div><button id="saveAsTxt" class="button">Salvar como TXT</button><button id="saveAsHtml" class="button">Salvar como HTML</button><button id="saveAsMd" class="button">Salvar como MD</button><button id="closeViewer" class="button">Fechar</button></div></div>`;const r=n.querySelector(".portaria-content"),a=n.querySelector(".portaria-index"),o=n.querySelector("#prevPortaria"),i=n.querySelector("#nextPortaria"),s=n.querySelector("#portariaCounter"),c=n.querySelector("#compactView"),l=n.querySelector("#toggleView");let d=0,u=!1,p=!0;function m(){if(r.innerHTML="",p)h(d);else for(let e=0;e<t.length;e++)h(e);s.textContent=`${d+1} / ${t.length}`,o.disabled=0===d,i.disabled=d===t.length-1}function h(e){const n=t[e],a=document.createElement("div"),o=n.match(/^# (.*)$/m),i=o?o[1]:"Título não encontrado",s=n.replace(/^# .*$/m,"").trim();a.innerHTML=`<h3>${i}</h3><div class="portaria-text">${u?i:s}</div>`,r.appendChild(a)}function f(e){const t=e.match(/^# (.*)$/m);return t?t[1]:"Título não encontrado"}function g(){a.innerHTML=t.map((e,t)=>`<a href="#" data-index="${t}">${f(e)}</a>`).join("")}o.onclick=()=>{d>0&&(d--,m())},i.onclick=()=>{d<t.length-1&&(d++,m())},c.onchange=()=>{u=c.checked,m()},l.onclick=()=>{p=!p,l.textContent=p?"Ver Todas":"Ver Uma",m()},a.onclick=e=>{"A"===e.target.tagName&&(e.preventDefault(),d=parseInt(e.target.dataset.index),m())},n.querySelector("#saveAsTxt").onclick=()=>v(t.join("\n\n---\n\n"),"portarias_tre_am.txt","text/plain"),n.querySelector("#saveAsHtml").onclick=()=>v(x(t),"portarias_tre_am.html","text/html"),n.querySelector("#saveAsMd").onclick=()=>v(t.join("\n\n---\n\n"),"portarias_tre_am.md","text/markdown"),n.querySelector("#closeViewer").onclick=()=>document.body.removeChild(n),g(),m(),document.body.appendChild(n)}function v(e,t,n){const r=new Blob([e],{type:n}),a=document.createElement("a");a.href=URL.createObjectURL(r),a.download=t,a.click()}function x(e){return`<!DOCTYPE html><html lang="pt-BR"><head><meta charset="UTF-8"><title>Portarias TRE-AM</title><style>body{font-family:Arial,sans-serif;line-height:1.6;max-width:800px;margin:0 auto;padding:20px;}h1{text-align:center;}.portaria{margin-bottom:30px;border-bottom:1px solid #ccc;padding-bottom:20px;}.portaria:last-child{border-bottom:none;}</style></head><body><h1>Portarias TRE-AM</h1>${e.map(e=>`<div class="portaria">${e}</div>`).join("")}</body></html>`}(async function(){try{const e=await o();console.log("Valor de e:",e);const t=i(e);console.log("Valor de t:",t);s(t)}catch(e){console.error("Erro ao processar o PDF:",e),alert("Ocorreu um erro ao processar o PDF")}})})();
